<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sys_script_email">
    <sys_script_email action="INSERT_OR_UPDATE">
        <name>x_24859_responded_resman</name>
        <new_lines_to_html>false</new_lines_to_html>
        <script><![CDATA[(function runMailScript(/* GlideRecord */ current, /* TemplatePrinter */ template,
/* Optional EmailOutbound */ email, /* Optional GlideRecord */ email_action,
/* Optional GlideRecord */ event) {
	
	//If we have no user_ref or no staff request id then bail.
	if (!current.u_user_ref || !event.parm1)
		return;
	
	//Get original staff request that started this event
	var rs = new GlideRecord('x_24859_ps_staffing_request');
	rs.addQuery('sys_id',event.parm1);
	rs.query();
	
	
	//Populate html with gig details
	if(rs.next()) {
		
		//Put a RE: in the subject? 
		email.setSubject('RE: ' + rs.getValue('short_description'));
		
		
		//Didnt work, override sender/from address
		//var poc = new GlideRecord('sys_user');
		//poc.addQuery('user_name',gs.getProperty('x_24859_ps.partner.poc.username'));
		//poc.query();
		//if(poc.next()) email.setFrom(poc.email);
		
		template.print('<p class="MsoNormal">&nbsp;</p><p class="MsoNormal"><strong>');
		template.print(rs.getValue('short_description'));
		template.print('</strong></p><p class="MsoNormal"><strong>Role</strong>: ');
		template.print(rs.getValue('role'));
		template.print('</p><p class="MsoNormal"><strong>Start Date</strong>: ');
		template.print(rs.getValue('start_date'));
		template.print('</p><p class="MsoNormal"><strong>End Date</strong>: ');
		template.print(rs.getValue('end_date'));
		template.print('</p><p class="MsoNormal"><strong>Hours</strong>: ');
		template.print(rs.getValue('hours'));
		template.print('</p><p class="MsoNormal"><strong>Rate</strong>: ');
		template.print(rs.getValue('rate'));
		template.print('</p><p class="MsoNormal"><strong>Work Location</strong>: ');
		template.print(rs.getValue('work_location'));
		template.print('</p>');
		
		rs.work_notes = "Email sent to " + event.parm2;
		rs.update();
	}
	
	
})(current, template, email, email_action, event);
]]></script>
        <sys_class_name>sys_script_email</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-02-06 21:31:11</sys_created_on>
        <sys_id>0dc9467a4f801300dc6a1b818110c7a5</sys_id>
        <sys_mod_count>2</sys_mod_count>
        <sys_name>x_24859_responded_resman</sys_name>
        <sys_package display_value="PS Staffing" source="x_24859_ps">3231be28db983200a0b2d100cf961966</sys_package>
        <sys_policy/>
        <sys_scope display_value="PS Staffing">3231be28db983200a0b2d100cf961966</sys_scope>
        <sys_update_name>sys_script_email_0dc9467a4f801300dc6a1b818110c7a5</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-02-19 22:59:36</sys_updated_on>
    </sys_script_email>
</record_update>
